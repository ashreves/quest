<h3>
    <a href="https://github.com/episphere/quest" target="_blank">quest.js</a> - questionnaire markup demo
</h3>

<table>
    <thead>
        <tr>
            <td>
                <div id=legend style="border: 1px solid black;" width="500px">
                    <h3>Legend</h3>
                    <p>Check Box = * or []</p>
                    <p>Age = |__|__|</p>
                    <p>Year = |__|__|__|__|</p>
                    <p>Input Box = |__| (two underlines)</p>
                    <p>Text Box = [text box] or |___| (three underlines)</p>
                    <p>Phone Number = |(###)-###-####|</p>
                </div>
            </td>
            <td>
                <div id=styling style="border: 1px solid black; width:500px; height:263px">
                    <h3>Styling</h3>
                    <input type="radio" name="styling" checked>No Style</input>
                    <input type="radio" name="styling">With Style 1</input>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <h3>markup (<a href="?questionnaries/demo.txt" id="demo">demo</a>)</h3>
            </td>
            <td style="color: navy;">
                <h3>quest.js rendering</h3>
            </td>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td id="markup" style="vertical-align:top"><textarea></textarea></td>
            <td id="rendering" style="vertical-align:top;"></td>
        </tr>
    </tbody>
</table>

<script src="replace2.js"></script>
<script src="questionnaire.js"></script>

<script>
    (async function() {
        console.log("local anonymous");
        var ta = document.querySelector("textarea");
        ta.style.height = 600;
        ta.style.width = 500;
        //ta.style.position='fixed'
        ta.style.backgroundColor = "#FAE5D3";
        ta.style.color = "navy";

        ta.onkeyup = ev => {

            rendering.innerHTML = transform(ta.value + "<END>") // <-- this is where quest.js is engaged
            if (document.querySelector(".question") != null) {
                document.querySelector(".question").classList.add("active")
            }
        }

        ta.innerHTML = "// type or paste questionnaire markup\n";
        // let table = document.querySelector("table");
        // let save = document.createElement("BUTTON");
        // save.innerHTML = "Save";
        // save.onclick = myFunction();
        // table.appendChild(save);

        // function myFunction() {
        //     console.log("attempting to save");
        // }

        var q = (location.search + location.hash).replace(/[\#\?]/g, "");
        if (q.length > 3) {
            ta.value = await (await fetch(q.split("&")[0])).text(); // getting the first of markup&css
            ta.onkeyup();
        }
        ta.style.width =
            parseInt(ta.parentElement.style.width.slice(0, -1)) - 5 + "%";
    })();
</script>